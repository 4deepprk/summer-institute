#read in interests from google sheet
our_interests<-read.csv("https://docs.google.com/spreadsheets/d/10dKwmFZkGPy4EHfoGbEzfsX0ACue4w55HDik79hfzQI/pub?gid=0&single=true&output=csv", row.names=1)
View(our_interests)
#read in interests from google sheet
our_interests<-read.csv("https://docs.google.com/spreadsheets/d/10dKwmFZkGPy4EHfoGbEzfsX0ACue4w55HDik79hfzQI/pub?gid=0&single=true&output=csv", row.names=1)
#read in interests from google sheet
our_interests<-read.csv("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=csv", row.names=1)
#read in interests from google sheet
our_interests<-read.csv("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=csv")
View(our_interests)
read.csv()
?read.csv()
#read in interests from google sheet
our_interests<-read.csv("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=csv", sheet = 2, row.names=1)
#read in interests from google sheet
our_interests<-read.xls("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=xls", sheet = 2, row.names=1)
#read in interests from google sheet
library(gdata)
install.packages('gdata')
#read in interests from google sheet
library(gdata)
our_interests<-read.xls("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=xls", sheet = 2, row.names=1)
our_interests<-read.xls("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=xlsx", sheet = 2, row.names=1)
install.packages("googlesheets")
#read in interests from google sheet
library(googlsheets)
#read in interests from google sheet
library(googlesheets)
library(xlsx)
install.packages('xlsx')
#read in interests from google sheet
library(xlsx)
our_interests<-read.xlsx("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=xlsx", sheet = 2, row.names=1)
#read in interests from google sheet
library(xlsx)
#read in interests from google sheet
library(readxl)
our_interests<-read_excel("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=xlsx", sheet = 2, row.names=1)
our_interests<-read_excel("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=xlsx", sheet = 2)
our_interests<-read_excel("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/pub?gid=0&single=true&output=xlsx", sheet = 2)
our_interests<-read_excel("https://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx", sheet = 2)
our_interests<-read_excel("https://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx", sheet = 2)
our_interests<-read_excel("http://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx", sheet = 2)
our_interests<-read_excel(path="https://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx", sheet = 2)
our_interests<-read.xls("https://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx", sheet = 2)
our_interests<-readxl::read_excel("https://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx", sheet = 2)
libary(googlesheets)
library(googlesheets)
key <- "1HT5B8SgkKqHdqHJmn5xiuaC04Ngb7dG9Tv94004vezA"
download_ss(key, to = "gapminder.xlsx")
library(googlesheets)
download_ss(key, to = "gapminder.xlsx")
test<-gs_url("https://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx")
test<-gs_key(key)
test<-gs_url("https://docs.google.com/spreadsheets/d/e/2PACX-1vS7iHRLzh2DwsCvkKkDzbcp1iYckREUVwRuF8D-HcmmLLva5IGdDNsdTv-tVfH4jiRYemCo-RdVk5tw/pub?output=xlsx")
test<-gs_url("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/edit#gid=0")
View(test)
glimpse(test)
our_interests %>%
gs_read(ws = "Princeton")
library(dplyr)
our_interests %>%
gs_read(ws = "Princeton")
test
our_interests<-gs_url("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/edit#gid=0")
key <- "1HT5B8SgkKqHdqHJmn5xiuaC04Ngb7dG9Tv94004vezA"
test<-gs_key(key)
out<-test$sheet_title=="Princeton"
out<-test$sheet_title
test
test$sheet_key
out<-gs_read(test)
gsheet<-gs_key("1HT5B8SgkKqHdqHJmn5xiuaC04Ngb7dG9Tv94004vezA")
gsheet
rm(test)
key <- "1HT5B8SgkKqHdqHJmn5xiuaC04Ngb7dG9Tv94004vezA"
test<-gs_key(key)
our_interests
results<-gs_read(our_interests, ws="Princeton")
View(results)
#read in interests from google sheet
library(googlesheets)
our_interests<-gs_url("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/edit#gid=0")
#organizer, enter your site's sheet name below
results<-gs_read(our_interests, ws="Princeton")
#read in interests from google sheet
library(googlesheets)
our_interests<-gs_url("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/edit#gid=0")
#organizer, enter your site's sheet name below
results<-gs_read(our_interests, ws="Princeton")
#create distance matrix
distance_matrix <- dist(results, method = "euclidean")
fit <- hclust(distance_matrix, method="ward")
# display dendogram
plot(fit)
fit <- hclust(distance_matrix, method="ward")
#read in interests from google sheet
library(googlesheets)
our_interests<-gs_url("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/edit#gid=0")
#organizer, enter your site's sheet name below
results<-gs_read(our_interests, ws="Princeton")
#create distance matrix
distance_matrix <- dist(results, method = "euclidean")
fit <- hclust(distance_matrix, method="ward".D)
fit <- hclust(distance_matrix, method="ward.D")
# display dendogram
plot(fit)
# draw dendogram with red borders around the 5 clusters
rect.hclust(fit, k=4, border="red")
#create distance matrix
distance_matrix <- dist(results, method = "euclidean")
fit <- hclust(distance_matrix, method="ward")
# display dendogram
plot(fit)
groups <- cutree(fit, k=4) # cut tree into 5 clusters
#create distance matrix
distance_matrix <- dist(results, method = "euclidean")
fit <- hclust(distance_matrix, method="ward.D")
# display dendogram
plot(fit)
View(results)
#create distance matrix
distance_matrix <- dist(results, method = "euclidean")
?dist
colnames(distance_matrix) <- rownames(results)
distance_matrix
#create distance matrix
dmatrix <- dist(results, method = "euclidean")
#create distance matrix
rownames(results) <- results$Name
dmatrix <- dist(results, method = "euclidean")
dmatrix
fit <- hclust(dmatrix, method="ward.D")
# display dendogram
plot(fit)
groups <- cutree(fit, k=4) # cut tree into 5 clusters
# draw dendogram with red borders around the 5 clusters
rect.hclust(fit, k=4, border="red")
final<-as.data.frame(NULL)
data$names<-NULL
library(dplyr)
library(vegan)
test<-sample_n(results, 4)
names<-paste(row.names(test), collapse=",")
diversity_score<-diversity(unlist(test))
data<-cbind(names, diversity_score)
library(dplyr)
library(vegan)
install.packages("vegan")
library(vegan)
for (i in 1:1000){
test<-sample_n(results, 4)
names<-paste(row.names(test), collapse=",")
diversity_score<-diversity(unlist(test))
data<-cbind(names, diversity_score)
final<-rbind(final, data)
print(i)
}
View(test)
#read in interests from google sheet
library(googlesheets)
our_interests<-gs_url("https://docs.google.com/spreadsheets/d/1RIeYYvtzEX2kkrXspP2npWBSd9_rRqtw6RywlGvCpsU/edit#gid=0")
#organizer, enter your site's sheet name below
results<-gs_read(our_interests, ws="Princeton")
#create distance matrix
rownames(results) <- results$Name
dmatrix <- dist(results, method = "euclidean")
fit <- hclust(dmatrix, method="ward.D")
# display dendogram
plot(fit)
groups <- cutree(fit, k=4) # cut tree into 5 clusters
# draw dendogram with red borders around the 5 clusters
rect.hclust(fit, k=4, border="red")
final<-as.data.frame(NULL)
data$names<-NULL
library(dplyr)
library(vegan)
test<-sample_n(results, 4)
names<-paste(row.names(test), collapse=",")
diversity_score<-diversity(unlist(test))
data<-cbind(names, diversity_score)
final<-rbind(final, data)
print(i)
}
test<-sample_n(results[,c(2:length(colnames)(results))], 4)
test<-sample_n(results, 4)
View(test)
names<-paste(row.names(test), collapse=",")
diversity_score<-diversity(unlist(test))
diversity_score<-diversity(unlist(test[,c(1:ncol(test))]))
test[,c(1:ncol(test))]
diversity_score<-diversity(unlist(test[,c(2:ncol(test))]))
data<-cbind(names, diversity_score)
data
row.names(test)
names<-paste(test$Name, collapse=",")
names
diversity_score<-diversity(unlist(test[,c(2:ncol(test))]))
data<-cbind(names, diversity_score)
final<-rbind(final, data)
print(i)
for (i in 1:1000){
test<-sample_n(results, 4)
names<-paste(test$Name, collapse=",")
diversity_score<-diversity(unlist(test[,c(2:ncol(test))]))
data<-cbind(names, diversity_score)
final<-rbind(final, data)
print(i)
}
final$diversity_score<-as.character(final$diversity_score)
final$diversity_score<-as.numeric(final$diversity_score)
final<-final[order(final$diversity_score, decreasing=TRUE),]
View(final)
head(final, 10)
